{"version":3,"file":"ChallengeViewUtil.js","sources":["../../../../../../src/v2/view-builder/utils/ChallengeViewUtil.js"],"sourcesContent":["/*!\n * Copyright (c) 2020, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { loc, View, createButton, _ } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport Enums from 'util/Enums';\nimport Util from 'util/Util';\nimport {\n  FASTPASS_FALLBACK_SPINNER_TIMEOUT,\n  IDENTIFIER_FLOW,\n  LOOPBACK_RESPONSE_STATUS_CODE,\n  OV_UV_ENABLE_BIOMETRICS_FASTPASS_DESKTOP, \n  OV_UV_ENABLE_BIOMETRICS_FASTPASS_MOBILE,\n  REQUEST_PARAM_AUTHENTICATION_CANCEL_REASON,\n} from '../utils/Constants';\n\nexport function appendLoginHint(deviceChallengeUrl, loginHint) {\n  if (deviceChallengeUrl && loginHint) {\n    deviceChallengeUrl += '&login_hint=' + loginHint;\n  }\n\n  return deviceChallengeUrl;\n}\n\nexport function doChallenge(view, fromView) {\n  const deviceChallenge = view.getDeviceChallengePayload();\n  const loginHint = view.options?.settings?.get('identifier');\n  const HIDE_CLASS = 'hide';\n  switch (deviceChallenge.challengeMethod) {\n  case Enums.LOOPBACK_CHALLENGE:\n    view.title = loc('deviceTrust.sso.redirectText', 'login');\n    view.add(View.extend({\n      className: 'loopback-content',\n      template: hbs`<div class=\"spinner\"></div>`\n    }));\n    view.doLoopback(deviceChallenge);\n    break;\n  case Enums.CUSTOM_URI_CHALLENGE:\n    view.title = loc('customUri.title', 'login');\n    view.add(View.extend({\n      className: 'skinny-content',\n      template: hbs`\n            <p>\n              {{i18n code=\"customUri.required.content.prompt\" bundle=\"login\"}}\n            </p>\n          `,\n    }));\n    view.add(createButton({\n      className: 'ul-button button button-wide button-primary',\n      title: loc('oktaVerify.open.button', 'login'),\n      id: 'launch-ov',\n      click: () => {\n        view.doCustomURI();\n      }\n    }));\n    view.add(View.extend({\n      className: 'skinny-content',\n      template: hbs`\n          <p>\n            {{i18n code=\"customUri.required.content.download.title\" bundle=\"login\"}}\n          </p>\n          <p>\n            <a href=\"{{downloadOVLink}}\" target=\"_blank\" id=\"download-ov\" class=\"link\">\n              {{i18n code=\"customUri.required.content.download.linkText\" bundle=\"login\"}}\n            </a>\n          </p>\n          `,\n      getTemplateData() {\n        return {\n          downloadOVLink: deviceChallenge.downloadHref\n        };\n      },\n    }));\n    view.customURI = appendLoginHint(deviceChallenge.href, loginHint);\n    view.doCustomURI();\n    break;\n  case Enums.UNIVERSAL_LINK_CHALLENGE:\n    view.title = loc('universalLink.title', 'login');\n    view.add(View.extend({\n      className: 'universal-link-content',\n      template: hbs`\n            <div class=\"spinner\"></div>\n            {{i18n code=\"universalLink.content\" bundle=\"login\"}}\n          `\n    }));\n    view.add(createButton({\n      className: 'ul-button button button-wide button-primary',\n      title: loc('oktaVerify.open.button', 'login'),\n      click: () => {\n        // only window.location.href can open universal link in iOS/MacOS\n        // other methods won't do, ex, AJAX get or form get (Util.redirectWithFormGet)\n        let deviceChallengeUrl = appendLoginHint(deviceChallenge.href, loginHint);\n        Util.redirect(deviceChallengeUrl);\n      }\n    }));\n    break;\n  case Enums.APP_LINK_CHALLENGE:\n    view.title = loc('appLink.title', 'login');\n    view.add(View.extend({\n      className: 'app-link-content',\n      template: hbs`\n        <div class=\"spinner {{hideClass}}\"></div>\n        <div class=\"appLinkContent {{hideClass}}\">{{i18n code=\"appLink.content\" bundle=\"login\"}}</div>\n      `,\n      getTemplateData() {\n        return { hideClass: HIDE_CLASS };\n      },\n      postRender() {\n        if (fromView === IDENTIFIER_FLOW) {\n          this.$('.spinner').removeClass(HIDE_CLASS);\n          setTimeout(_.bind(()=> {\n            const data = { label: loc('goback', 'login') };\n            this.options.appState.trigger('updateFooterLink', data);\n            this.$('.spinner').addClass(HIDE_CLASS);\n            this.$('.appLinkContent').removeClass(HIDE_CLASS);\n          }, this), FASTPASS_FALLBACK_SPINNER_TIMEOUT);\n        } else {\n          this.$('.appLinkContent').removeClass(HIDE_CLASS);\n        }\n      },\n    }));\n    view.add(createButton({\n      className: `${HIDE_CLASS} al-button button button-wide button-primary`,\n      title: loc('oktaVerify.open.button', 'login'),\n      click: () => {\n        // only window.location.href can open app link in Android\n        // other methods won't do, ex, AJAX get or form get (Util.redirectWithFormGet)\n        let deviceChallengeUrl = appendLoginHint(deviceChallenge.href, loginHint);\n        Util.redirect(deviceChallengeUrl, window, true);\n      },\n      postRender() {\n        if (fromView === IDENTIFIER_FLOW) {\n          setTimeout(_.bind(()=> {\n            this.$el.removeClass(HIDE_CLASS);\n          }, this), FASTPASS_FALLBACK_SPINNER_TIMEOUT);\n        } else {\n          this.$el.removeClass(HIDE_CLASS);\n        }\n      }\n    }));\n    break;\n  case Enums.CHROME_DTC:\n    // reusing the existing message for Chrome DTC\n    view.title = loc('deviceTrust.sso.redirectText', 'login');\n    view.add(View.extend({\n      className: 'chrome-dtc-content',\n      template: hbs`\n            <div class=\"spinner\"></div>\n          `\n    }));\n    view.doChromeDTC(deviceChallenge);\n    break;\n  }\n}\n\nexport function cancelPollingWithParams(appState, pollingCancelAction, cancelReason, statusCode, showFormErrors) {\n  const actionParams = {};\n  actionParams[REQUEST_PARAM_AUTHENTICATION_CANCEL_REASON] = cancelReason;\n  actionParams[LOOPBACK_RESPONSE_STATUS_CODE] = statusCode;\n  appState.trigger('invokeAction', pollingCancelAction, actionParams, showFormErrors);\n}\n\nexport function getBiometricsErrorOptions(error, isMessageObj) {\n  let errorSummaryKeys;\n  if (isMessageObj) {\n    errorSummaryKeys  = Object.values(error?.value[0]?.i18n);\n  } else {\n    errorSummaryKeys = error?.responseJSON?.errorSummaryKeys;\n  }\n\n  const isBiometricsRequiredMobile = errorSummaryKeys \n      && errorSummaryKeys.includes(OV_UV_ENABLE_BIOMETRICS_FASTPASS_MOBILE);\n  const isBiometricsRequiredDesktop = errorSummaryKeys \n      && errorSummaryKeys.includes(OV_UV_ENABLE_BIOMETRICS_FASTPASS_DESKTOP);\n  let options = [];\n\n  if (!isBiometricsRequiredMobile && !isBiometricsRequiredDesktop) {\n    return options;\n  }\n\n  const bulletPoints = [\n    loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point1', 'login'),\n    loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point2', 'login'),\n    loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point3', 'login')\n  ];\n\n  // Add an additional bullet point for desktop devices\n  if (isBiometricsRequiredDesktop) {\n    bulletPoints.push(\n      loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point4', 'login')\n    );\n  }\n\n  options = {\n    type: 'error',\n    className: 'okta-verify-uv-callout-content',\n    title: loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.title', 'login'),\n    subtitle: loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.description', 'login'),\n    bullets: bulletPoints,\n  };\n\n  return options;\n}\n\nexport function createInvisibleIFrame(iFrameId, iFrameSrc) {\n  const iFrameView = View.extend({\n    tagName: 'iframe',\n    id: iFrameId,\n    attributes: {\n      src: iFrameSrc,\n    },\n    initialize() {\n      this.el.style.display = 'none';\n    }\n  });\n  return iFrameView;\n}\n"],"names":["appendLoginHint","deviceChallengeUrl","loginHint","doChallenge","view","fromView","_view$options","_view$options$setting","deviceChallenge","getDeviceChallengePayload","options","settings","get","HIDE_CLASS","challengeMethod","Enums","LOOPBACK_CHALLENGE","title","loc","add","View","extend","className","template","_Handlebars2","main","container","depth0","helpers","partials","data","doLoopback","CUSTOM_URI_CHALLENGE","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","undefined","escapeExpression","hooks","helperMissing","nullContext","createButton","id","click","doCustomURI","helper","alias1","alias2","alias3","getTemplateData","downloadOVLink","downloadHref","customURI","href","UNIVERSAL_LINK_CHALLENGE","Util","redirect","APP_LINK_CHALLENGE","alias4","hideClass","postRender","IDENTIFIER_FLOW","$","removeClass","setTimeout","_","bind","label","appState","trigger","addClass","FASTPASS_FALLBACK_SPINNER_TIMEOUT","window","$el","CHROME_DTC","doChromeDTC","cancelPollingWithParams","pollingCancelAction","cancelReason","statusCode","showFormErrors","actionParams","REQUEST_PARAM_AUTHENTICATION_CANCEL_REASON","LOOPBACK_RESPONSE_STATUS_CODE","getBiometricsErrorOptions","error","isMessageObj","errorSummaryKeys","_error$value$","values","value","i18n","_error$responseJSON","responseJSON","isBiometricsRequiredMobile","includes","OV_UV_ENABLE_BIOMETRICS_FASTPASS_MOBILE","isBiometricsRequiredDesktop","OV_UV_ENABLE_BIOMETRICS_FASTPASS_DESKTOP","bulletPoints","push","type","subtitle","bullets","createInvisibleIFrame","iFrameId","iFrameSrc","iFrameView","tagName","attributes","src","initialize","el","style","display"],"mappings":"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"}