{"version":3,"file":"EnrollAuthenticatorGoogleAuthenticatorView.js","sources":["../../../../../../../src/v2/view-builder/views/google-authenticator/EnrollAuthenticatorGoogleAuthenticatorView.js"],"sourcesContent":["import { loc, View } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport { addCustomButton, BaseForm, BaseView } from '../../internals';\nimport BaseAuthenticatorView from '../../components/BaseAuthenticatorView';\nimport EnrollGoogleAuthenticatorBarcodeView from './EnrollGoogleAuthenticatorBarcodeView';\nimport EnrollAuthenticatorManualSetupView from './EnrollAuthenticatorManualSetupView';\n\nconst VIEW_TO_DISPLAY = 'viewToDisplay';\nconst viewToDisplayState = {\n  BARCODE: 'barcode',\n  MANUAL: 'manual',\n  ENTER_CODE: 'enterCode',\n};\n\nconst Body = BaseForm.extend({\n  title() {\n    return loc('oie.enroll.google_authenticator.setup.title', 'login');\n  },\n\n  noButtonBar: true,\n\n  className: 'oie-enroll-google-authenticator',\n\n  enterCodeSubtitle: View.extend({\n    template: hbs`\n      <div class=\"google-authenticator-setup-info-title enter-code-title\">\n      {{i18n code=\"oie.enroll.google_authenticator.enterCode.title\" bundle=\"login\"}}\n      </div>\n    `,\n  }),\n\n  getUISchema() {\n    const schema = BaseForm.prototype.getUISchema.apply(this, arguments);\n    // https://oktainc.atlassian.net/browse/OKTA-555191\n    const nextButton = addCustomButton({\n      className: 'google-authenticator-next',\n      title: loc('oform.next', 'login'),\n      click: () => {\n        this.model.set(VIEW_TO_DISPLAY, viewToDisplayState.ENTER_CODE);\n      }\n    });\n\n    const verifyButton = addCustomButton({\n      className: 'google-authenticator-verify',\n      title: loc('oform.verify', 'login'),\n      click: () => {\n        this.$el.submit();\n      }\n    });\n\n    schema[0].showWhen = {\n      viewToDisplay: viewToDisplayState.ENTER_CODE,\n    };\n\n    // Add Enter Code Subtitle\n    schema.unshift({\n      View: this.enterCodeSubtitle,\n      selector: '.o-form-fieldset-container',\n      showWhen: {\n        viewToDisplay: viewToDisplayState.ENTER_CODE,\n      }\n    });\n\n    schema.push(\n      {\n        View: EnrollGoogleAuthenticatorBarcodeView,\n        selector: '.o-form-fieldset-container',\n        showWhen: {\n          viewToDisplay: viewToDisplayState.BARCODE,\n        }\n      }, {\n        View: EnrollAuthenticatorManualSetupView,\n        selector: '.o-form-fieldset-container',\n        showWhen: {\n          viewToDisplay: viewToDisplayState.MANUAL,\n        }\n      }, {\n        label: false,\n        className: 'shared-secret no-translate',\n        type: 'text',\n        placeholder: this.options.appState.get('currentAuthenticator').contextualData.sharedSecret,\n        disabled: true,\n        showWhen: {\n          viewToDisplay: viewToDisplayState.MANUAL,\n        }\n      },\n      {\n        View: nextButton,\n        showWhen: {\n          viewToDisplay: (val) => val === viewToDisplayState.BARCODE || val === viewToDisplayState.MANUAL,\n        }\n      },\n      {\n        View: verifyButton,\n        showWhen: {\n          viewToDisplay: (val) => val === viewToDisplayState.ENTER_CODE,\n        }\n      },\n    );\n    return schema;\n  },\n});\n\nexport default BaseAuthenticatorView.extend({\n  Body,\n  createModelClass() {\n    const ModelClass = BaseView.prototype.createModelClass.apply(this, arguments);\n    const local = Object.assign(\n      {\n        viewToDisplay: {\n          value: 'barcode',\n          type: 'string',\n          required: true,\n          values: [viewToDisplayState.BARCODE, viewToDisplayState.MANUAL, viewToDisplayState.ENTER_CODE],\n        }\n      },\n      ModelClass.prototype.local,\n    );\n    return ModelClass.extend({\n      local,\n    });\n  },\n});\n"],"names":["VIEW_TO_DISPLAY","viewToDisplayState","BARCODE","MANUAL","ENTER_CODE","Body","BaseForm","extend","title","loc","noButtonBar","className","enterCodeSubtitle","View","template","_Handlebars2","main","container","depth0","helpers","partials","data","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","undefined","escapeExpression","hooks","helperMissing","nullContext","getUISchema","schema","apply","arguments","nextButton","addCustomButton","click","model","set","verifyButton","$el","submit","showWhen","viewToDisplay","unshift","selector","push","EnrollGoogleAuthenticatorBarcodeView","EnrollAuthenticatorManualSetupView","label","type","placeholder","options","appState","get","contextualData","sharedSecret","disabled","val","BaseAuthenticatorView","createModelClass","ModelClass","BaseView","local","assign","value","required","values"],"mappings":"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"}