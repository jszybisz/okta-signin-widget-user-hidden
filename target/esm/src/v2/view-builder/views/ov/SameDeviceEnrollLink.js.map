{"version":3,"file":"SameDeviceEnrollLink.js","sources":["../../../../../../../src/v2/view-builder/views/ov/SameDeviceEnrollLink.js"],"sourcesContent":["import { View } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport { FORMS as RemediationForms } from '../../../ion/RemediationConstants';\n\nexport default View.extend({\n  className: 'ov-same-device-enroll-text',\n  template: hbs `\n        {{{i18n code=\"oie.enroll.okta_verify.select.channel.ovOnThisDevice\"\n        bundle=\"login\" $1=\"<a class='ov-same-device-enroll-link' href='#'>$1</a>\"}}}\n      `,\n  postRender: function() {\n    const appState = this.options && this.options.appState;\n    const model = this.model;\n\n    this.$('.ov-same-device-enroll-link').click(function() {\n      if (!appState || !model) {\n        return;\n      }\n\n      const sameDeviceChannel = 'samedevice';\n      const remediations = appState.get('remediations');\n      const selectEnrollmentChannelRemediation = remediations.find((remediation) => {\n        return remediation.name === RemediationForms.SELECT_ENROLLMENT_CHANNEL;\n      });\n\n      if (!selectEnrollmentChannelRemediation) {\n        return;\n      }\n      const idField = selectEnrollmentChannelRemediation.uiSchema?.find((schema) =>\n        schema.name === 'authenticator.id');\n      if (!idField) {\n        return;\n      }\n      // filter selected channel\n      const sameDeviceChannelField = selectEnrollmentChannelRemediation.uiSchema?.find((schema) =>\n        schema.name === 'authenticator.channel');\n      if (!sameDeviceChannelField) {\n        return;\n      }\n      sameDeviceChannelField.options = sameDeviceChannelField.options?.filter((option) =>\n        option.value === sameDeviceChannel);\n      sameDeviceChannelField.value = sameDeviceChannelField.options[0]?.value || sameDeviceChannel;\n      sameDeviceChannelField.sublabel = null;\n\n      model.set('authenticator.channel', sameDeviceChannelField.value);\n      model.set('authenticator.id', idField.value);\n      model.set('formName', selectEnrollmentChannelRemediation.name);\n      appState.trigger('saveForm', model);\n    });\n  },\n});\n"],"names":["View","extend","className","template","_Handlebars2","main","container","depth0","helpers","partials","data","stack1","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","undefined","hooks","helperMissing","nullContext","postRender","appState","options","model","$","click","_selectEnrollmentChan","_selectEnrollmentChan2","_sameDeviceChannelFie","_sameDeviceChannelFie2","sameDeviceChannel","remediations","get","selectEnrollmentChannelRemediation","find","remediation","name","RemediationForms","SELECT_ENROLLMENT_CHANNEL","idField","uiSchema","schema","sameDeviceChannelField","filter","option","value","sublabel","set","trigger"],"mappings":"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"}