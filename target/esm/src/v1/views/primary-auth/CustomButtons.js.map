{"version":3,"file":"CustomButtons.js","sources":["../../../../../../src/v1/views/primary-auth/CustomButtons.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, $, View, loc, createButton, internal } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport OAuth2Util from 'util/OAuth2Util';\nconst SharedUtil = internal.util.Util;\nconst dividerTpl = hbs('<div class=\"auth-divider\">\\\n      <span class=\"auth-divider-text\">{{text}}</span>\\\n    </div>');\nconst formTitleTpl = hbs('<h2 data-se=\"o-form-head\" class=\"okta-form-title o-form-head\">{{title}}</h2>');\nexport default View.extend({\n  className: 'primary-auth-container',\n\n  children: function() {\n    const children = [];\n    const socialIdpButtons = this.settings.get('configuredSocialIdps');\n    const pivButton = this.settings.get('piv');\n    const customButtons = this.settings.get('customButtons');\n    const divider = dividerTpl({ text: loc('socialauth.divider.text', 'login') });\n\n    if (this.settings.get('hasPivCard')) {\n      children.push(this._createPivButton(pivButton));\n    }\n\n    _.each(\n      socialIdpButtons,\n      function(button) {\n        children.push(this._createSocialIdpButton(button));\n      },\n      this\n    );\n\n    _.each(\n      customButtons,\n      function(button) {\n        children.push(this._createCustomButton(button));\n      },\n      this\n    );\n\n    // If the social auth buttons have to be above the Okta form, the title moves from\n    // primary auth form to the social auth (above the buttons) and the divider goes below\n    // the buttons (in between social auth and primary auth). If social auth needs to go below\n    // Okta form, just add the divider at the top of the social auth container. The title still\n    // lives in primary auth form.\n    if (this.settings.get('socialAuthPositionTop')) {\n      children.unshift(formTitleTpl({ title: loc('primaryauth.title', 'login') }));\n      // Divider between Primary Auth and the Social Auth\n      children.push(divider);\n    } else {\n      children.unshift(divider);\n    }\n\n    return children;\n  },\n\n  _createSocialIdpButton: function(options) {\n    return createButton({\n      attributes: {\n        'data-se': options.dataAttr,\n      },\n      className: options.className,\n      title: function() {\n        return options.text || loc(options.i18nKey);\n      },\n      click: function(e) {\n        e.preventDefault();\n        if (this.settings.get('oauth2Enabled')) {\n          OAuth2Util.getTokens(this.settings, { idp: options.id }, this.options.currentController);\n        } else {\n          const baseUrl = this.settings.get('baseUrl');\n          let params;\n          const lastAuthResponse = this.options.appState.get('lastAuthResponse');\n          if (this.options.appState.get('usingDeviceFlow')) {\n            params = $.param({\n              stateToken: lastAuthResponse?.stateToken,\n            });\n          } else {\n            params = $.param({\n              fromURI: this.settings.get('relayState'),\n            });\n          }\n          const targetUri = `${baseUrl}/sso/idps/${options.id}?${params}`;\n          SharedUtil.redirect(targetUri);\n        }\n      },\n    });\n  },\n\n  _createPivButton: function(options) {\n    let className = options.className || '';\n    return createButton({\n      attributes: {\n        'data-se': 'piv-card-button',\n      },\n      className: className + ' piv-button',\n      title: options.text || loc('piv.cac.card', 'login'),\n      click: function(e) {\n        e.preventDefault();\n        this.options.appState.trigger('navigate', 'signin/verify/piv');\n      },\n    });\n  },\n\n  _createCustomButton: function(options) {\n    return createButton({\n      attributes: {\n        'data-se': options.dataAttr,\n      },\n      className: options.className + ' default-custom-button',\n      title: function() {\n        return options.title || loc(options.i18nKey);\n      },\n      click: options.click,\n    });\n  },\n});\n"],"names":["SharedUtil","internal","util","Util","dividerTpl","_Handlebars2","template","main","container","depth0","helpers","partials","data","helper","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","undefined","escapeExpression","hooks","helperMissing","nullContext","formTitleTpl","View","extend","className","children","socialIdpButtons","settings","get","pivButton","customButtons","divider","text","loc","push","_createPivButton","_","each","button","_createSocialIdpButton","_createCustomButton","unshift","title","options","createButton","attributes","dataAttr","i18nKey","click","e","preventDefault","OAuth2Util","getTokens","idp","id","currentController","baseUrl","params","lastAuthResponse","appState","$","param","stateToken","fromURI","targetUri","redirect","trigger"],"mappings":"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"}